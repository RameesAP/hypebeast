<body>
    <div class="container-fluid position-relative d-flex p-0">

        <div class="content">



            <!-- Table Start -->
            {{!-- <div class="btn btn-default">
                <a href="/admin/add-product" <button type="submit" class="btn btn-primary mt-4">Add Product</button></a>
            </div> --}}
            <div class="container-fluid pt-5 px-5">

                <div class="col-12">

                    <div class="row g-4">

                        <div class="bg-secondary rounded h-100 p-4">

                            <h6 class="mb-4">Orders Mangement</h6>

                            <div class="table-responsive">
                                <table class="table">
                                    <thead>
                                        <tr>
                                            {{!-- <th scope="col">No</th> --}}
                                            <th scope="col">User Id</th>

                                            <th scope="col">Date/Time</th>
                                            <th scope="col">Payment</th>
                                            <th scope="col">Order Status</th>
                                            <th scope="col">Delivery Status</th>
                                            <th scope="col">Total Price</th>
                                            <th scope="col">Products</th>

                                        </tr>
                                    </thead>
                                    <tbody>
                                        {{#each viewAllOrders}}
                                        <tr>
                                            {{!-- <th scope="row">1</th> --}}
                                            <td>{{this.userid}}</td>

                                            <td>{{this.date}}</td>
                                            {{!-- <td><img style="width: 80px;height: 110px;"
                                                    src="/product-image/{{this.image.[0]}}" alt=""></td> --}}
                                            <td>{{this.paymentDetails}}</td>
                                            <td>{{this.status}}</td>
                                            <td>
                                                <div class="dropdown">
                                                    <button class="btn btn-primary dropdown-toggle" type="button"
                                                        id="dropdownMenuButton1" data-bs-toggle="dropdown"
                                                        aria-expanded="false">
                                                        {{this.deliveryStatus}}
                                                    </button>
                                                    <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton1">

                                                        <li><a class="dropdown-item"
                                                                onclick="productShip('{{this._id}}')">Shipped</a></li>
                                                        <li><a class="dropdown-item"
                                                                onclick="productDeliver('{{this._id}}')">Delivered</a>
                                                        </li>
                                                        <li><a class="dropdown-item"
                                                                onclick="cancelOrder('{{this._id}}')">canceled</a></li>

                                                    </ul>
                                                </div>
                                            </td>
                                            <td>
                                                {{this.totalPrice}}{{this.grandTotal}}


                                            </td>
                                            <td>
                                                <a href="/admin//ordered-prod/{{this._id}}"><button type="submit"
                                                        class="btn btn-primary mt-4">Ordered Product</button></a>

                                            </td>
                                        </tr>
                                        {{/each}}
                                        {{!-- <tr>
                                            <th scope="row">2</th>
                                            <td>Mark</td>
                                            <td>Otto</td>
                                            <td>mark@email.com</td>
                                            <td>UK</td>
                                            <td>456</td>
                                            <td>Member</td>
                                        </tr>
                                        <tr>
                                            <th scope="row">3</th>
                                            <td>Jacob</td>
                                            <td>Thornton</td>
                                            <td>jacob@email.com</td>
                                            <td>AU</td>
                                            <td>789</td>
                                            <td>Member</td>
                                        </tr> --}}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Table End -->


            {{!--
            <!-- Footer Start -->
            <div class="container-fluid pt-4 px-4">
                <div class="bg-secondary rounded-top p-4">
                    <div class="row">
                        <div class="col-12 col-sm-6 text-center text-sm-start">
                            &copy; <a href="#">Your Site Name</a>, All Right Reserved.
                        </div>
                        <div class="col-12 col-sm-6 text-center text-sm-end">
                            <!--/*** This template is free as long as you keep the footer author’s credit link/attribution link/backlink. If you'd like to use the template without the footer author’s credit link/attribution link/backlink, you can purchase the Credit Removal License from "https://htmlcodex.com/credit-removal". Thank you for your support. ***/-->
                            Designed By <a href="https://htmlcodex.com">HTML Codex</a>
                            <br>Distributed By: <a href="https://themewagon.com" target="_blank">ThemeWagon</a>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Footer End --> --}}
        </div>
        <!-- Content End -->


        <!-- Back to Top -->
        <a href="#" class="btn btn-lg btn-primary btn-lg-square back-to-top"><i class="bi bi-arrow-up"></i></a>
    </div>

    <!-- JavaScript Libraries -->
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script>

        async function productShip(id) {
            console.log(id, 'axioos function')
            axios({
                method: 'post',
                url: '/admin/productShip/',
                data: { id }
            }).then((response) => {
                location.reload()
            }).catch((response) => {
                console.log(response)
            })
        }

        async function productDeliver(id) {
            console.log(id, 'axioosssfuncrion')
            axios({
                method: 'post',
                url: '/admin/productDeliver/',
                data: { id }
            }).then((response) => {
                location.reload()
            }).catch((response) => {
                console.log(response)
            })
        }


        async function cancel(id) {
            console.log(id, 'axioosssfuncrion')
            axios({
                method: 'post',
                url: '/admin/cancelOrder/',
                data: { id }
            }).then((response) => {


                location.reload()

            }).catch((response) => {
                console.log(response)
            })
        }

        function cancelOrder(id) {
            swal({
                title: "Are you sure?",

                icon: "warning",
                buttons: true,
                dangerMode: true,
            })
                .then((willDelete) => {
                    if (willDelete) {
                        this.cancel(id)
                        swal("Poof! Order cancelled successfully!", {
                            icon: "success",
                        });
                    } else {
                        swal("Order is safe!");
                    }
                });
        }




    </script>

    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="lib/chart/chart.min.js"></script>
    <script src="lib/easing/easing.min.js"></script>
    <script src="lib/waypoints/waypoints.min.js"></script>
    <script src="lib/owlcarousel/owl.carousel.min.js"></script>
    <script src="lib/tempusdominus/js/moment.min.js"></script>
    <script src="lib/tempusdominus/js/moment-timezone.min.js"></script>
    <script src="lib/tempusdominus/js/tempusdominus-bootstrap-4.min.js"></script>
    <!-- JavaScript Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3"
        crossorigin="anonymous"></script>
    <!-- Template Javascript -->
    <script src="js/main.js"></script>
</body>